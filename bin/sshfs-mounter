#!/bin/sh
# Mounts SSH account locally
# sshfs-mounter -h dev2 -p ~/ -l dev2

# Handle args
while [[ $# > 1 ]]
do
key="$1"

case $key in
    -h|--host)
    HOST="$2"
    shift
    ;;
    -p|--remote-path)
    REMOTE_PATH="$2"
    shift
    ;;
    -l|--label)
    LABEL="$2"
    shift
    ;;
    *)
    # unknown option
    ;;
esac
shift
done
echo
if [[ ! -z "$LABEL" && ! -z "$HOST" && ! -z "$REMOTE_PATH" ]]; then
  # Check if already mounted
  if mount | grep ~/mnt/${LABEL} > /dev/null; then
    echo "Already mounted at ~/mnt/${LABEL}"
  else
    # Check ~/mnt/${LABEL} exists
    if [ ! -d "$DIRECTORY" ]; then
      mkdir ~/mnt/${LABEL}
    fi
    # Mount that trick.
    sshfs ${HOST}:${REMOTE_PATH} ~/mnt/${LABEL} -o auto_cache,reconnect,defer_permissions,negative_vncache,volname=${LABEL}
  fi
fi
